function doGet() {
  const folderId = "1hJASNVPbYhDYEFm0zfiuX6Umr6Hulu0h";
  const folder = DriveApp.getFolderById(folderId);
  const files = folder.getFiles();

  let list = [];

  while (files.hasNext()) {
    const f = files.next();

    f.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);

    list.push({
      name: f.getName(),
      embed: "https://drive.google.com/file/d/" + f.getId() + "/preview"
    });
  }

  return ContentService
    .createTextOutput(JSON.stringify(list))
    .setMimeType(ContentService.MimeType.JSON);
}
