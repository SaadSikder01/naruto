<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Admin Upload</title>
</head>
<body>

<h2>Upload Video to Google Drive</h2>

<input type="file" id="video">
<button onclick="upload()">Upload</button>

<p id="msg"></p>

<script>
async function upload() {
    const file = document.getElementById("video").files[0];
    if (!file) return alert("Please select a video first!");

    document.getElementById("msg").innerText = "Uploading... Please wait";

    const reader = new FileReader();
    reader.onload = async () => {
        const base64 = reader.result.split(",")[1];

        let res = await fetch(
            "https://script.google.com/macros/s/AKfycbwO-cef9rbYGsyFW0HyN98senKLi-_bKK8qCpG1-R4zuZwcZDvr5Dbenh3SHTykjWo6/exec",
            {
                method: "POST",
                headers: {
                    "Content-Type": file.type,
                    "X-File-Name": file.name
                },
                body: base64
            }
        );

        let url = await res.text();

        if (url.startsWith("ERROR")) {
            document.getElementById("msg").innerText = "Upload failed: " + url;
        } else {
            localStorage.setItem("latestVideo", url);
            document.getElementById("msg").innerHTML =
                "Upload Complete!<br>Video Link Saved.";
        }
    };

    reader.readAsDataURL(file);
}
</script>

</body>
</html>
